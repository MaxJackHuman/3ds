---
title: "Установка arm9loaderhax"
permalink: /installing-arm9loaderhax.html
---

В последнем этапе гайда устанавливаем arm9loaderhax и настраиваем Luma3DS, таким образом загрузка будет занимать значительно меньше времени. За эту возможность благодарим [AuroraWright](https://github.com/AuroraWright/) и его программу SafeA9LHInstaller.
{: .notice}

Для установки arm9loaderhax будем использовать [форк AuroraWright](https://github.com/AuroraWright/arm9loaderhax).
{: .notice--info}

Так же настроим запуск пейлоадеров из под arm9loaderhax, благодаря чему будем иметь возможность сделать анбрик консоли и восстановить SysNAND из бекапа практически в любой момент. 
{: .notice--info}

**НЕЛЬЗЯ использовать чужой OTP. Брик гарантирован!**
{: .notice--danger}

#### Что будем делать?

В этом разделе мы будем двигаться к одной великой цели - установке arm9loaderhax.

Можно уверенно заявить, что arm9loaderhax - наилучший из возможных типов эксплойтов. Все потому, что он устанавливается непосредственно в NAND и запускается ДО запуска операционной системы приставки. Кроме прочего, a9lh работает с любой прошивкой и, благодаря тому, что запускается-то до ОС, в большинстве ситуаций, удалить его случайно не выйдет. А еще этот эксплойт позволяет запускать различного рода загрузчики, которые помогут восстановить консоль даже из тех состояний, которые в обычном случае привели бы вас в сервисный центр. 

Файл под названием `arm9loaderhax.bin` - исполняемый файл, написанный под arm9, который запускает arm9loaderhax до загрузки системы. К слову, luma3DS делает запуск загрузчиков гораздо удобнее. Ничего не нужно заменять или переименовывать. достаточно зажать кнопку при старте системы, присвоенную необходимому загрузчику. 

`arm9loaderhax.bin`, используемый в этом гайде - исполняемый файл самой  Luma3DS от [AuroraWright](https://github.com/AuroraWright/), загружающий пропатченный SysNAND. Таким образом мы загружаем систему сразу в кастомную прошивку без необходимости EmuNAND. 

После того, как мы установим arm9loaderhax и настроем Luma3DS, мы восстановим бекап прошивки, сделанный ранее. У нас будет консоль с arm9loaderhax и прошивкой, софтом и сейвами, с которыми приставка была ДО взлома. 

В процессе мы установим и настроем следующие программы: 
+  **FBI** *(устанавливает игры и программы в формате CIA)*
+  **Luma3DS Updater** *(программа для упрощения обновления нашей кастомной прошивки)*
+  **Hourglass9** *(многоцелевая утилита, выполняющие различные функции, связанные с NAND и картриджами)*
+  **freeshop** *(open source клон eShop, облегчающий поиск игр)*

#### Что понадобится:

* [`aeskeydb.bin`](torrents/aeskeydb.torrent) - <code class="highlighterrouge"><a href="magnet:?xt=urn:btih:18b3a17f78e2376e05feaa150749d9fd689b25dc"><i class="fa fa-magnet" aria-hidden="true"></i></a></code>
* [`data_input_v3.zip`](torrents/data_input_v3.torrent) - <code class="highlighterrouge"><a href="magnet:?xt=urn:btih:a1195c9f7ab650fa7c7bf020b51fc19ea8d9440c"><i class="fa fa-magnet" aria-hidden="true"></i></a></code>
* [`fbi-2.4.2-injectable.zip`](torrents/fbi-2.4.2-injectable.torrent) - <code class="highlighterrouge"><a href="magnet:?xt=urn:btih:f978b4cf5eda72823240b9c649f3fd2940a9f525"><i class="fa fa-magnet" aria-hidden="true"></i></a></code>
* Версия SafeA9LHInstaller соответствующая вашему устройству:
  + [Версия, совместимая с New 3DS](https://github.com/AuroraWright/SafeA9LHInstaller/releases/latest)
  + [Версия, совместимая с Old3DS и 2DS](https://github.com/AuroraWright/SafeA9LHInstaller/releases/tag/v2.0.3)
* Свежая версия [arm9loaderhax](https://github.com/AuroraWright/arm9loaderhax/releases/latest)
* Свежая версия [Luma3DS](https://github.com/AuroraWright/Luma3DS/releases/latest)
* Свежая версия [hblauncher_loader](https://github.com/yellows8/hblauncher_loader/releases/latest)
* Свежая версия [Hourglass9](https://github.com/d0k3/Hourglass9/releases/latest)
* Свежая версия [Luma3DS Updater](https://github.com/Hamcha/lumaupdate/releases/latest)
* Свежая версия [DspDump](https://github.com/Cruel/DspDump/releases/latest)
* Свежая версия [FBI](https://github.com/Steveice10/FBI/releases/)
* Свежая версия [freeshop](https://github.com/Cruel/freeShop/releases)
* The Homebrew [Starter Kit](http://smealum.github.io/ninjhax2/starter.zip)

#### Что делать: 

##### Часть I - Подготовка

{% capture notice-5 %}
**Убедитесь в том, что ваша карта памяти исправна и правильно отформатирована!**

**Использование испорченной карты может привести к БРИКУ!**

**Если вы не уверены, что карта работает правильно, проверьте КП на ошибки, используя [H2testw (Windows)](h2testw-(windows)), [F3 (Linux)](f3-(linux)), or [F3X (Mac)](f3x-(mac))!**
{% endcapture %}

<div class="notice--danger">{{ notice-5 | markdownify }}</div>

1. **Если на карте памяти есть папка `/files9/`, скопируйте ее в надежное место (лучше сделать не одну копию и на разных носителях, а так же в облаке); файлы, находящиеся в этой папке файлы могут вернуть приставку к жизни, в случае проблем.**
2. Создайте папку `cias` в корне карты памяти.
4. **Удалите папку `a9lh` из корня КП, если таковая там есть.**
  + **Если вы по ошибке установили arm9loaderhax, используя `OTP.bin` от другой консоли, то будет БРИК!**
3. Удалите папку `3ds` из корня КП, если таковая там есть.
4. **Скопируйте _содержимое_ архива `starter.zip` в корень карты памяти.**
  + Все это нужно сделать, чтобы актуализировать программы, содержащиеся в папке 3ds.
5. Скопируйте _содержимое_ архива SafeA9LHInstaller в корень карты памяти.
6. Скопируйте папку `a9lh` из архива `data_input_v3.zip` в корень карты памяти. 
7. Скопируйте _содержимое_ архива arm9loaderhax (release.7z) в папку `a9lh` в корне КП.
9. Скопируйте `hblauncher_loader.cia` из архива hblauncher_loader в папку `/cias/` в корне КП.
10. Скопируйте `lumaupdater.cia` из архива Luma3DS Updater в папку `/cias/` в корне КП.
11. Скопируйте `FBI.cia` из архива FBI в папку `/cias/` в корне КП.
11. Скопируйте `freeShop-x.x.x.cia` в папку `/cias/` в корне КП.
12. **Скопируйте `arm9loaderhax.bin` из архива Luma3DS в корень карты памяти, согласившись на перезапись.**
13. Создайте папку `luma` в корне карты памяти.
14. Создайте папку `payloads` в папке `luma` в корне карты памяти.
15. Скопируйте `Hourglass9.bin` из архива Hourglass9 в папку `/luma/payloads/` в корне КП и переименуйте `Hourglass9.bin` в `start_Hourglass9.bin`
16. Скопируйте `aeskeydb.bin` в папку `/files9/` в корне КП.
17. Скопируйте `DspDump.3dsx` в папку `/3ds/` в корне КП.
18. Скопируйте _содержимое_ архива `fbi-2.4.2-injectable.zip` в папку `/files9/` в корне КП.
19. Очистите экстра-данные домашнего экрана, перейдя в папку `/Nintendo 3DS/(32-х значный ID)/(32-х значный ID)/extdata/00000000/` на карте памяти
    + EUR Region: Delete `00000098`
    + JPN Region: Delete `00000082`
    + USA Region: Delete `0000008f`
    + CHN Region: Delete `000000A1`
    + KOR Region: Delete `000000A9`
    + TWN Region: Delete `000000B1`

##### Часть II - Установка arm9loaderhax

1. Верните карту памяти в 3DS
2. Для того, чтобы установить a9lh, следуйте инструкции, предназначенной для вашего устройства:

+ Old 3DS
    + Необходимо находиться на прошивке 2.1.0.
    + Перейдите по ссылке на своей приставке `https://goo.gl/xUMUJB`. 
      + При возникновении ошибки, обратитесь к разделу [Проблемы и их решения](troubleshooting#ts_browser).
      + Если экран выглядит некорректно, обратитесь к разделу [Проблемы и их решения](troubleshooting#ts_safe_a9lh_screen).
    + Нажмите (SELECT) для установки.
    + Сейчас установщик поставит arm9loaderhax на вашу консоль (буквально секунда).
    + Нажмите любую кнопку, чтобы выключить приставку. При необходимости, выключите консоль долгим нажатием на кнопку включения. 
    + Достаньте карту памяти из приставки и вставьте ее в ПК.
    + Скопируйте файл `OTP.bin` из папки `/a9lh/` на карте памяти в надежное место (лучше сделать не одну копию и на разных носителях, а так же в облаке) и верните карту обратно в консоль. Помните, что `OTP.bin` уникален для каждой приставки. 
  + New 3DS
    + Войдите в Homebrew launcher через удобную для вас точку входа.
    + Запустите SafeA9LHInstaller
      + Если экран выглядит некорректно, обратитесь к разделу [Проблемы и их решения](troubleshooting#ts_safe_a9lh_screen)
    + Нажмите (SELECT) для установки
    + Сейчас установщик поставит arm9loaderhax на вашу консоль (буквально секунда).
    + Нажмите любую кнопку, чтобы выключить приставку. При необходимости, выключите консоль долгим нажатием на кнопку включения. 

##### Часть III - Настройка Luma3DS

1. Зажмите (SELECT) и включите приставку, чтобы попасть в меню настройки Luma3DS.
  + Важно зажать кнопку до того, как включать приставку.
  + Если после запуска экран черный, то следуйте рекомендациям из [раздела с помощью](troubleshooting#ts_sys_a9lh).   
  + Если после загрузки запускается SafeA9LHInstaller, то следуйте рекомендациям из [раздела с помощью](troubleshooting#ts_sys_a9lh).   
2. С помощью кнопки (А) отметьте следующие пункты:     
  + **"Autoboot SysNAND"**
  + **"Use SysNAND FIRM if booting with R (A9LH)"**
  + **"Show NAND or user string in System Settings"**
3. Если у вас **New 3DS**, так же отметьте следующие пункты: 
  + **"New 3DS CPU" to "Clock+L2(x)"**
    + Это увеличит частоту кадров в некоторых играх.
    + Если какие-то игры работают некорректно, отключите эту опцию.
4. Нажмите (START), чтобы сохранить настройки и перезагрузиться. 
  + Если приставка зависла, зажмите кнопку питания до тех пор, пока консоль не выключится. 
  + Если после запуска экран черный, то следуйте рекомендациям из [раздела с помощью](troubleshooting#ts_sys_a9lh).   

##### Часть IV - Восстановление системы

Если вы начинали гайд со взломанной приставкой с EmuNAND, то самое время заняться [переносом EmuNAND в SysNAND](move-emunand).
{: .notice--info}

1. **Если вы пользователь Old 3DS или 2DS, выполнивший [2.1.0 ctrtransfer](2.1.0-ctrtransfer), следуйте этой инструкции:**
    + Скопируйте `NANDmin.bin` в папку `/files9/` вашей карты памяти, если его там нет (созданный, при 2.1.0 ctrtransfer подойдет).
    + Запустите Hourglass9 из под arm9loaderhax, включив приставку с зажатой кнопкой (START). 
    + Перейдите в "SysNAND Backup/Restore"
    + Выберите SysNAND Restore (keep a9lh)", выберите ваш бекап (`NANDmin.bin`) и подтвердите восстановление.
    + Нажмите (START) для перезагрузки системы.
    + Если после запуска экран черный, то следуйте рекомендациям из [раздела с 9.2.0 ctrtransfer](9.2.0-ctrtransfer).
1. Если вы делали бекап системы с прошивкой 4.0.0 - 4.5.0:
  + Скачайте [этот файл](http://nus.cdn.c.shop.nintendowifi.net/ccs/download/0004013800000002/00000056) и переименуйте его в `firmware.bin`.
  + Скачайте [этот файл](http://nus.cdn.c.shop.nintendowifi.net/ccs/download/0004013800000002/cetk).
  + Скопируйте `firmware.bin` и `cetk` в папку `/luma/` на карте памяти.
  + После обновления прошивки на 3DS удалите оба этих файла.
2. 10. Обновите прошивку 3DS. Для этого зайдите в Системные настройки, Прочие настройки, листайте вправо до тех пор, пока не дойдете до предпоследнего пункта - Обновление ("System Update").
  + Да, это безопасно. Точно. На 100%!
  + Если выскочит ошибка, поставьте в настройках подключения, в настройках DNS "Получить DNS автоматически" в положение "Да".
  + Если выскакивает ошибка и версия вашей прошивки ниже 9.2.0, [проделайте 9.2.0 ctrtransfer](9.2.0-ctrtransfer).


##### Часть V - Внедрение FBI

2. Запустите Hourglass9 из под arm9loaderhax, включив приставку с зажатой кнопкой (START). 
2. Перейдите в "SysNAND Backup/Restore", выберите "Health&Safety Dump", чтобы сдампить на карту памяти оригинальный Health & Safety в файл `hs.app` **(стрелками (ВВЕРХ) / (ВНИЗ) и (ВЛЕВО) / (ВПРАВО) можно менять имя дампа)**.
3. Нажмите (B), затем выберите "Health&Safety Inject".
8. Выберите файл с внедренным FBI формата `.app`, соответствующий вашему региону. 
4. Нажмите (A) для подтверждения. 
9. Нажмите (Start) для перезагрузки.
10. Если при запуске Health & Safety запускается не FBI и вы в прошлом даунгрейдились с помощью Gateway, милости просим в раздел [проблемы и их решения](troubleshooting#gw_fbi).

##### Часть VI - Заканчиваем настройку

2. Запустите Информация о здоровье и безопасности (Health and Safety) (это теперь FBI).
3. Выберите "SD".
4. Выберите "cias".
5. Наведите курсор на <current directory>, нажмите (А) и выберите Install all CIAs.
6. Установятся все приложения, находящиеся в этой папке. 
9. Нажмите (B), чтобы вернуться в папку "SD".
4. Выберите arm9loaderhax.bin, нажмите (A) и выберите “Copy”.
9. Нажмите (B), чтобы вернуться в главное меню FBI.
10. Выберите "CTR NAND".
11. Выберите "\<current directory>".
12. Нажмите "Paste", затем нажмите (A) для подтверждения.
8. Нажмите кнопку (home) для перехода на домашний экран. 
9. Запустите Homebrew Launcher.
10. Выберите "DSP Dump".
11. Нажмите (START), после завершения для выхода.
12. Перезагрузите приставку, удерживая (START)для входа в Hourglass9.
13. Перейдите в "SysNAND Backup/Restore", выберите "Health&Safety Inject".
14. Выберите `hs.app` (оригинальный файл, не содержащий FBI), нажмите (A) для подтверждения внедрения. 
15. Нажмите (SELECT) в главном меню Hourglass9, чтобы извлечь КП.
15. Нажмите (START) для перезагрузки с извлеченной картой памяти.
  + Необходимо хотя бы раз загрузиться без карты памяти, чтобы настроить прошивку, расположенную в CTRNAND.
16. Нажимая (A) выберите следующие пункты: 
  + **"Show NAND or user string in System Settings"**
3. Если у вас **New 3DS**, так же отметьте следующие пункты: 
  + **"New 3DS CPU" to "Clock+L2(x)"**
    + Это увеличит частоту кадров в некоторых играх.
    + Если какие-то игры работают некорректно, отключите эту опцию.
14. Вставьте карту памяти в приставку и нажмите (START) для того, чтобы сохранить настройки и перезагрузить приставку. 

##### Часть VII - Восстановление тикетов

Эту часть следует выполнять только тем, кто выполнял ctrtransfer и у кого после этого пропали установленные приложения. 
{: .notice--info}

1. Запустите FBI.
2. Выберите "SD".
3. Выберите "files9".
4. Выберите "\<current directory>".
5. Выберите "Install and delete all tickets".
6. Подождите. Будет казаться, что приставка зависла, но это не так. Дайте ей немного подумать.
7. Нажмите (A) для подтверждения.
8. Нажмите (B), чтобы отказаться от установки тикетов из CDN.
9. Выйдите из FBI нажатием кнопки (home).

___

В случае проблем с запуском приложений DSi / DS (например, картриджи DS или DSiWare перестали работать), [обратитесь к разделу с проблемами и их решениями](troubleshooting#twl_broken).
{: .notice--warning}

{% capture notice-10 %}
Теперь вы можете использовать Luma3DS Updater для обновления кастомной прошивки. Запустите его и нажмите (А).
Это не обновление системы; это приложение скачивает обновленные файлы luma3DS, находящиеся на карте памяти.
Это значит, что версия luma3ds ctrnand не обновляется этим приложением. 
{% endcapture %}

<div class="notice--info">{{ notice-10 | markdownify }}</div>

{% capture notice-6 %}   
Вы загружаетесь сразу в кастомную прошивку, находящуюся в SysNAND. 
Для запуска конфигуратора luma3DS, нужно зажать (SELECT) и, не отпуская кнопку, включить приставку 
Для запуска Hourglass9 - крутой программы для работы с NAND и картриджами - нужно зажать (START) и, не отпуская кнопку, включить приставку.
{% endcapture %}

<div class="notice--info">{{ notice-6 | markdownify }}</div>

Для обновления A9LH, следуйте инструкциям из раздела [обновление A9LH](updating-a9lh).
{: .notice--info}

Для использования [NTR CFW](https://github.com/44670/BootNTR/), положите `ntr.bin`, находящийся в архиве на [этой странице](https://github.com/44670/BootNTR/releases), в корень карты памяти. Затем установите [`BootNTR.cia`](https://github.com/astronautlevel2/BootNTR/releases/latest).
{: .notice--info}

После всех настроек и манипуляций рекомендую сделать бекап через Hourglass9 (SysNAND Backup/Restore, SysNAND Backup). Получившийся файл `NANDmin.bin` сохраните в надежном месте. В случае чего, он может спасти вам консоль. 
{: .notice--info}

Можно удалить бекап из папки `/files9/`, коль уж вы сохранили его в надежном месте. 
{: .notice--info}

{% capture notice-7 %}
**Можно удалить ненужные файлы и папки из карты памяти. Важно **оставить** файлы, указанные в этой таблице:** 

| **Файлы и папки, которые нельзя удалять с КП:** |
|:----------------------------------------------:|
| `3ds` |
| `files9` |
| `hblauncherloader` |
| `luma` |
| `Nintendo 3DS` |
| `arm9loaderhax.bin` |
| `boot.3dsx` |
{% endcapture %}

<div class="notice--info">{{ notice-7 | markdownify }}</div>

Если вы хотите сменить регион вашего устройства, вам сюда - [Смена региона](region-changing).
{: .notice--success}

Для того, чтобы держать свой a9lh в актуальном состоянии, следуйте этой инструкции - [Обновление A9LH](updating-a9lh).
{: .notice--success}

Рекомендую ознакомиться с различными фишками, которые умеет Luma3DS [в этой статье](https://github.com/AuroraWright/Luma3DS/wiki/Options-and-usage).
{: .notice--success}
